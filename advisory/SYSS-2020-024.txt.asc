-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Advisory ID: SYSS-2020-024
Product: Qiata FTA
Manufacturer: Secudos GmbH
Affected Version(s): <= Qiata FTA 1.70.19
Tested Version(s): Qiata FTA 1.70.19
Vulnerability Type: Cross-Site Scripting (CWE-79)
Risk Level: Medium
Solution Status: Solved
Manufacturer Notification: 2020-06-17
Solution Date: 2020-08-12
Public Disclosure: 2020-09-28
CVE Reference: CVE-2020-14294
Author of Advisory: Patrick Hener, SySS GmbH

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Overview:

Qiata FTA is a secure file transfer appliance.

The manufacturer describes the product as follows (see [1]):

"Qiata File Transfer Appliances (FTAs) provide the ability to easily and
securely exchange files with internal or external users."

Due to insufficient input validation of user provided input it is vulnerable
to Cross-Site Scripting.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Vulnerability Details:

Within every transfer initiated, both the sender and the receiver of the
transfer are able to communicate via a comment function.

This comment function does in fact alter user input and changing appearances
of the special characters '<' and '>' by flipping the direction of the special
character. Also quotation marks are escaped properly.

An attacker can use the behaviour to construct a malicious string, which will
embed a persistent cross-site scripting within the transfer comments. The
exploit will be executed when viewing the transfers comments.

For a user not registered within the file transfer appliance the exploit will
be executed directly when opening the provided transfer URL.

This vulnerability is also discovered at the global notice board, whereas
no escaping could be identified.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Proof of Concept (PoC):

The following string will result in a persistent cross-site scripting
displaying the message: "Persistent XSS by SySS GmbH", when executed. All an
attacker needs to do is to enter the malicious string as a comment to a transfer.

">img src=x onerror=alert(String.fromCharCode(80,101,114,115,105,115,116,101,
110,116,32,88,83,83,32,98,121,32,83,121,83,83,32,71,109,98,72)) /<"


~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Solution:

The vulnerability was fixed with the version Qiata FTA 2.00.00. Update to at least this version.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Disclosure Timeline:

2020-06-02: Vulnerability discovered
2020-06-17: Vulnerability reported to manufacturer
2020-08-12: Patch released by manufacturer
2020-09-28: Public disclosure of vulnerability

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

References:

[1] Product website for Qiata FTA
    https://www.secudos.de/en/products/qiata-file-transfer
[2] SySS Security Advisory SYSS-2020-024
    https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2020-024.txt
[3] SySS Responsible Disclosure Policy
    https://www.syss.de/en/news/responsible-disclosure-policy/

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Credits:

This security vulnerability was found by Patrick Hener of SySS
GmbH.

E-Mail: patrick.hener@syss.de
Public Key: https://www.syss.de/fileadmin/dokumente/PGPKeys/Patrick_Hener.asc
Key ID: 5C708555930AA477
Key Fingerprint: 9CB7 1E87 BD83 64B7 38F2  3434 5C70 8555 930A A477

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Disclaimer:

The information provided in this security advisory is provided "as is"
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS Web
site.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Copyright:

Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en

-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEnLceh72DZLc48jQ0XHCFVZMKpHcFAl9sTxgACgkQXHCFVZMK
pHePBBAAnZNVsvanbaj5azoG+mzuK9yFtOs5WxrYIaRlrXbscM0NZifA8iai7Bui
KQRFAB/y6Bx5GAdHRdNR4Q8VwgFEk8TwBOQRn4FG5vp2IdMYhzBWm9/b5l6lAlv9
T8x7bsge7DS62rt8AX3+JNLlHzWVYe2lpA4mXeRPk2E55Ms1kqgR3JdMJhyXLpCp
zl4dK0LdXxOqSGEtaQG9ApDIxYe5V5Bj/h5TMB9qAydxc1kdpShPWNBpVJqnhzjQ
0JqJ3+pVmasmfAOPRqH1lJbBv1dtAclyn7NvPqNyGmmN16a07ANlhWomiAJ6IF2o
y9CUQaHVJe9mhl3JeG5K/oVSejZibGyFBwkiO3Wx3TtwdksxBKG7VrvX3McEFIWb
CoajcHRx07vQfHKyfxQKombvgaMSVuuRwyTVyVPhKPvIQYWDE8tAJegHZW8p8585
FcoOmq3zTpgFkFD+ZI+yLnEPgnsiOR092uSy6ui94hWvH5sTCKI0cgE6zxCAT6EM
ebMuztUijSKfEKtefw6SMNKnOkYEaxBsNwYJ+Ld15FEtnRx1iuenKYXmNPBSqEqC
ViragdUVChSNA2hMpDfybrzSKu2uSqJ0DsKEWynVsfCa/CeFKXFU9Ii3LF1/wDa8
LLqbXWO55Orct6EdakK/OOkMAR2ZB/wlurt+Bg7RapaLpk+N7gA=
=Xkru
-----END PGP SIGNATURE-----
